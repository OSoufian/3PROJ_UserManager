version: "3.8"
services:
  local_pgdb:
    image: postgres
    container_name: local_pgdb
    restart: always
    ports:
      - "5432:5432"
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: admin
    volumes:
      - local_pgdata:/var/lib/postgresql/data
  pgadmin:
    image: dpage/pgadmin4
    container_name: pgadmin4_container
    restart: always
    ports:
      - "5050:80"
    environment:
      PGADMIN_DEFAULT_EMAIL: contact@cyprientaib.com
      PGADMIN_DEFAULT_PASSWORD: admin
    volumes:
      - pgadmin-data:/var/lib/pgadmin
    links:
      - "local_pgdb"
  file_manager:
    image: file-manager
    container_name: file_manager 
    environment:
      AppListen: ":80"
      PostgresHost: local_pgdb
      PostgresUser: postgres
      PostgresPassword: admin
      PostgresDatabase: postgres
      PostgresPort: 5432

        # chats:
        #   image: chats-api
        #   environment:
        #     - AppListen=":80"
        #     - VideoStore="/mnt/video"
        #     - ImageStore="/mnt/image"
        #   volumes:
        #     - videos:/mnt/video
        # - images:/mnt/video
    links:
      - "local_pgdb"

  userApi:
    image: user-manager 
    container_name: user_api
    environment:
      PostgresHost: local_pgdb
      PostgresUser: postgres
      PostgresPassword: admin
      PostgresDatabase: postgres
      PostgresPort: 5432
      FilesApi: file_manager
      RPDisplayName: LocalTest
      RPID: localhost
      RPOrigin: http://localhost:80
      RPIcon: https://duo.com/logo.png
      AppListen: ":80"
    ports:
      - "3000:80"
    links:
      - "local_pgdb"
      - "file_manager"


volumes:
  local_pgdata:
  pgadmin-data:
  images:
  videos:
